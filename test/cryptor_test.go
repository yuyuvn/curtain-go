package test

import (
	"../lib"
	"fmt"
	"testing"
)

func TestCryptor(t *testing.T) {
	got := lib.Cryptor([]byte{0x19, 0x86, 0x57, 0x22, 0x38, 0x41, 0xac, 0xe1, 0x6d, 0xef, 0x52, 0xdf, 0x7d, 0x78, 0xd0, 0x93}, []byte{0x02, 0x03, 0x04, 0x05})
	expect := []byte{0x02, 0xdb, 0x82, 0x80, 0x69, 0x09, 0x01, 0xd0, 0xea, 0xef, 0x01, 0x7f, 0x71, 0xb8, 0x26, 0x9e, 0x84}
	if fmt.Sprint(got) != fmt.Sprint(expect) {
		t.Errorf("cryptor not correct, expect: %x, got: %x", expect, got)
	}
}
